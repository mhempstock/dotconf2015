<form script="autodiscover.js">
<label>Agenda</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="radio" token="date" searchWhenChanged="true">
      <label>Day</label>
      <default>2015-09-22</default>
      <choice value="2015-09-22">Tuesday</choice>
      <choice value="2015-09-23">Wednesday</choice>
      <choice value="2015-09-24">Thursday</choice>
    </input>
    <input type="multiselect" token="skillLevel" searchWhenChanged="true">
      <label>Skill Level</label>
      <search>
        <query>|inputlookup confSessions | dedup skillLevel</query>
      </search>
      <fieldForLabel>skillLevel</fieldForLabel>
      <fieldForValue>skillLevel</fieldForValue>
      <valuePrefix>skillLevel="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <delimiter> OR </delimiter>
      <choice value="*">ALL</choice>
      <default>*</default>
    </input>
    <input type="multiselect" token="track">
      <label>Track</label>
      <search>
        <query>|inputlookup confSessions | dedup track</query>
      </search>
      <fieldForLabel>track</fieldForLabel>
      <fieldForValue>track</fieldForValue>
      <valuePrefix>track="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <delimiter> OR </delimiter>
      <choice value="*">ALL</choice>
      <default>*</default>
    </input>
    <input type="multiselect" token="products" searchWhenChanged="true">
      <label>Product</label>
      <choice value="*">ALL</choice>
      <search>
        <query>|inputlookup confSessions | makemv products delim=";;" |mvexpand products | dedup products</query>
      </search>
      <fieldForLabel>products</fieldForLabel>
      <fieldForValue>products</fieldForValue>
      <default>*</default>
      <valuePrefix>products="*</valuePrefix>
      <valueSuffix>*"</valueSuffix>
      <delimiter> AND </delimiter>
    </input>
    <input type="multiselect" token="ownSessions" searchWhenChanged="true">
      <label>Own Sessions</label>
      <search>
        <query>|inputlookup confSessions | dedup title</query>
      </search>
      <fieldForLabel>title</fieldForLabel>
      <fieldForValue>Session_ID</fieldForValue>
      <valuePrefix>Session_ID="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <delimiter> OR </delimiter>
      <choice value="">None</choice>
      <default></default>
    </input>
  </fieldset>
  <row>
    <panel>
      <html>
        <p>Click on item to view more details of session</p>
      <div id="demo-view" class="splunk-view" data-require="app/dotconf2015/components/gantt/gantt" 
                     data-options='{ "managerid": "agenda",
                     "startField": "_time",
                     "durationField": "duration",
                     "categoryLabel": "type",
                     "categoryField": "type",
                     "seriesLabel": "track",
                     "seriesField": "track",
                     "extrasField" : "extra",
                     "timeAxisMode" : "DATA_RANGE",
                     "tokenName": "Session_ID",
                     "tokenField": "Session_ID"}'/>              
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$hidden$">
      <table>
        <search id="agenda">
          <query>|inputlookup confSessions | search startDate="$date$"  $skillLevel$ $track$ $products$   | append [|inputlookup confSessions |search startDate="$date$" $ownSessions$| eval type="Own Plan"]  | convert timeformat="%F %H:%M" mktime(startTime) AS _time | convert timeformat="%F %H:%M" mktime(endTime)             | eval duration=endTime-_time | eval extra="{\"title\":\""+title+"\",\"Skill Level\":\""+skillLevel+"\",\"Location\":\""+location+"\"}" | table startTime duration title track type _time extra Session_ID</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
  <row>
    <panel depends="$Session_ID$">
      <table>
        <search>
          <query>|inputlookup confSessions | search Session_ID="$Session_ID$" | table startTime endTime title description  location speakers |makemv speakers delim=";;"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="drilldown">none</option>
        <option name="dataOverlayMode">none</option>
        <option name="linkView">search</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</form>
